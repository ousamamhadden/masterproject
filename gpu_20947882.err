Loaded module: python3/3.6.2
Loaded dependency [numpy/1.13.1-python-3.6.2-openblas-0.2.20]: openblas/0.2.20
Loaded module: numpy/1.13.1-python-3.6.2-openblas-0.2.20

Loading numpy/1.13.1-python-3.6.2-openblas-0.2.20
  Loading requirement: openblas/0.2.20
Loaded module: scipy/0.19.1-python-3.6.2
Loaded module: matplotlib/2.0.2-python-3.6.2
Loaded module: cuda/11.6
Generating train split: 0 examples [00:00, ? examples/s]/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/datasets/download/streaming_download_manager.py:778: FutureWarning: The 'verbose' keyword in pd.read_csv is deprecated and will be removed in a future version.
  return pd.read_csv(xopen(filepath_or_buffer, "rb", download_config=download_config), **kwargs)
Generating train split: 1109 examples [00:00, 6192.73 examples/s]Generating train split: 1109 examples [00:00, 5908.91 examples/s]
Map:   0%|          | 0/1000 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Map: 100%|██████████| 1000/1000 [00:01<00:00, 852.66 examples/s]Map: 100%|██████████| 1000/1000 [00:01<00:00, 838.64 examples/s]
Map:   0%|          | 0/1109 [00:00<?, ? examples/s]Map:  90%|█████████ | 1000/1109 [00:01<00:00, 928.98 examples/s]Map: 100%|██████████| 1109/1109 [00:01<00:00, 911.66 examples/s]Map: 100%|██████████| 1109/1109 [00:01<00:00, 902.99 examples/s]
The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
`low_cpu_mem_usage` was None, now set to True since model is quantized.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:20<00:20, 20.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:21<00:00,  9.00s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:21<00:00, 10.65s/it]
Some weights of GemmaForSequenceClassification were not initialized from the model checkpoint at google/gemma-2b and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/peft/utils/other.py:143: FutureWarning: prepare_model_for_int8_training is deprecated and will be removed in a future version. Use prepare_model_for_kbit_training instead.
  warnings.warn(
Detected kernel version 5.4.268, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py:322: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
  0%|          | 0/139 [00:00<?, ?it/s]  1%|▏         | 2/139 [00:01<01:56,  1.18it/s]  2%|▏         | 3/139 [00:04<03:59,  1.76s/it]  3%|▎         | 4/139 [00:08<05:16,  2.34s/it]  4%|▎         | 5/139 [00:10<05:14,  2.35s/it]  4%|▍         | 6/139 [00:12<04:57,  2.24s/it]  5%|▌         | 7/139 [00:14<04:42,  2.14s/it]  6%|▌         | 8/139 [00:17<05:08,  2.36s/it]  6%|▋         | 9/139 [00:20<05:52,  2.71s/it]  7%|▋         | 10/139 [00:23<05:54,  2.75s/it]  8%|▊         | 11/139 [00:26<06:14,  2.93s/it]  9%|▊         | 12/139 [00:28<05:36,  2.65s/it]  9%|▉         | 13/139 [00:32<05:53,  2.80s/it] 10%|█         | 14/139 [00:35<06:34,  3.16s/it] 11%|█         | 15/139 [00:37<05:24,  2.61s/it] 12%|█▏        | 16/139 [00:39<05:19,  2.60s/it] 12%|█▏        | 17/139 [00:44<06:48,  3.34s/it] 13%|█▎        | 18/139 [00:48<06:43,  3.33s/it] 14%|█▎        | 19/139 [00:50<06:01,  3.01s/it] 14%|█▍        | 20/139 [00:52<05:31,  2.79s/it] 15%|█▌        | 21/139 [00:54<04:50,  2.46s/it] 16%|█▌        | 22/139 [00:57<04:55,  2.53s/it] 17%|█▋        | 23/139 [00:59<04:31,  2.34s/it] 17%|█▋        | 24/139 [01:01<04:37,  2.41s/it] 18%|█▊        | 25/139 [01:05<05:21,  2.82s/it] 19%|█▊        | 26/139 [01:08<05:24,  2.87s/it] 19%|█▉        | 27/139 [01:11<05:11,  2.78s/it] 20%|██        | 28/139 [01:13<05:07,  2.77s/it] 21%|██        | 29/139 [01:16<04:47,  2.61s/it] 22%|██▏       | 30/139 [01:19<05:16,  2.90s/it] 22%|██▏       | 31/139 [01:22<05:16,  2.93s/it] 23%|██▎       | 32/139 [01:24<04:41,  2.63s/it] 24%|██▎       | 33/139 [01:26<04:18,  2.44s/it] 24%|██▍       | 34/139 [01:29<04:41,  2.68s/it] 25%|██▌       | 35/139 [01:32<04:40,  2.69s/it] 26%|██▌       | 36/139 [01:34<04:03,  2.36s/it] 27%|██▋       | 37/139 [01:38<05:01,  2.96s/it] 27%|██▋       | 38/139 [01:41<04:53,  2.90s/it] 28%|██▊       | 39/139 [01:44<04:53,  2.94s/it] 29%|██▉       | 40/139 [01:48<05:19,  3.23s/it] 29%|██▉       | 41/139 [01:50<04:56,  3.02s/it] 30%|███       | 42/139 [01:53<04:50,  3.00s/it] 31%|███       | 43/139 [01:56<04:58,  3.11s/it] 32%|███▏      | 44/139 [01:59<04:39,  2.94s/it] 32%|███▏      | 45/139 [02:03<04:53,  3.13s/it] 33%|███▎      | 46/139 [02:05<04:27,  2.88s/it] 34%|███▍      | 47/139 [02:09<04:48,  3.13s/it] 35%|███▍      | 48/139 [02:11<04:19,  2.85s/it] 35%|███▌      | 49/139 [02:14<04:28,  2.99s/it] 36%|███▌      | 50/139 [02:17<04:12,  2.84s/it] 37%|███▋      | 51/139 [02:19<04:02,  2.76s/it] 37%|███▋      | 52/139 [02:21<03:46,  2.61s/it] 38%|███▊      | 53/139 [02:24<03:41,  2.57s/it] 39%|███▉      | 54/139 [02:26<03:38,  2.58s/it] 40%|███▉      | 55/139 [02:29<03:35,  2.56s/it] 40%|████      | 56/139 [02:32<03:44,  2.71s/it] 41%|████      | 57/139 [02:36<04:06,  3.01s/it] 42%|████▏     | 58/139 [02:38<03:55,  2.91s/it] 42%|████▏     | 59/139 [02:42<04:02,  3.03s/it] 43%|████▎     | 60/139 [02:44<03:51,  2.93s/it] 44%|████▍     | 61/139 [02:46<03:22,  2.59s/it] 45%|████▍     | 62/139 [02:48<02:57,  2.30s/it] 45%|████▌     | 63/139 [02:52<03:33,  2.80s/it] 46%|████▌     | 64/139 [02:55<03:29,  2.79s/it] 47%|████▋     | 65/139 [03:00<04:15,  3.46s/it] 47%|████▋     | 66/139 [03:02<03:51,  3.17s/it] 48%|████▊     | 67/139 [03:06<03:52,  3.23s/it] 49%|████▉     | 68/139 [03:10<04:08,  3.50s/it] 50%|████▉     | 69/139 [03:14<04:17,  3.67s/it] 50%|█████     | 70/139 [03:17<04:14,  3.69s/it] 51%|█████     | 71/139 [03:21<04:11,  3.71s/it] 52%|█████▏    | 72/139 [03:25<04:06,  3.68s/it] 53%|█████▎    | 73/139 [03:29<04:07,  3.75s/it] 53%|█████▎    | 74/139 [03:31<03:32,  3.27s/it] 54%|█████▍    | 75/139 [03:35<03:38,  3.41s/it] 55%|█████▍    | 76/139 [03:37<03:12,  3.06s/it] 55%|█████▌    | 77/139 [03:40<03:06,  3.00s/it] 56%|█████▌    | 78/139 [03:42<02:54,  2.86s/it] 57%|█████▋    | 79/139 [03:46<03:06,  3.11s/it] 58%|█████▊    | 80/139 [03:49<03:04,  3.12s/it] 58%|█████▊    | 81/139 [03:52<03:03,  3.16s/it] 59%|█████▉    | 82/139 [03:55<02:44,  2.89s/it] 60%|█████▉    | 83/139 [03:56<02:23,  2.57s/it] 60%|██████    | 84/139 [04:00<02:40,  2.92s/it] 61%|██████    | 85/139 [04:03<02:41,  2.98s/it] 62%|██████▏   | 86/139 [04:06<02:39,  3.01s/it] 63%|██████▎   | 87/139 [04:10<02:51,  3.29s/it] 63%|██████▎   | 88/139 [04:12<02:23,  2.82s/it] 64%|██████▍   | 89/139 [04:15<02:22,  2.86s/it] 65%|██████▍   | 90/139 [04:18<02:27,  3.02s/it] 65%|██████▌   | 91/139 [04:24<03:03,  3.83s/it] 66%|██████▌   | 92/139 [04:27<02:52,  3.68s/it] 67%|██████▋   | 93/139 [04:30<02:32,  3.31s/it] 68%|██████▊   | 94/139 [04:33<02:27,  3.27s/it] 68%|██████▊   | 95/139 [04:36<02:19,  3.18s/it] 69%|██████▉   | 96/139 [04:39<02:19,  3.24s/it] 70%|██████▉   | 97/139 [04:42<02:13,  3.17s/it] 71%|███████   | 98/139 [04:45<02:07,  3.10s/it] 71%|███████   | 99/139 [04:47<01:50,  2.77s/it] 72%|███████▏  | 100/139 [04:51<01:53,  2.91s/it] 73%|███████▎  | 101/139 [04:54<01:55,  3.04s/it] 73%|███████▎  | 102/139 [04:57<01:58,  3.19s/it] 74%|███████▍  | 103/139 [05:01<01:53,  3.16s/it] 75%|███████▍  | 104/139 [05:03<01:41,  2.89s/it] 76%|███████▌  | 105/139 [05:07<01:49,  3.22s/it] 76%|███████▋  | 106/139 [05:10<01:42,  3.11s/it] 77%|███████▋  | 107/139 [05:11<01:23,  2.59s/it] 78%|███████▊  | 108/139 [05:13<01:15,  2.45s/it] 78%|███████▊  | 109/139 [05:16<01:16,  2.56s/it] 79%|███████▉  | 110/139 [05:20<01:27,  3.03s/it] 80%|███████▉  | 111/139 [05:23<01:24,  3.02s/it] 81%|████████  | 112/139 [05:25<01:12,  2.70s/it] 81%|████████▏ | 113/139 [05:28<01:10,  2.71s/it] 82%|████████▏ | 114/139 [05:30<01:05,  2.63s/it] 83%|████████▎ | 115/139 [05:33<01:06,  2.78s/it] 83%|████████▎ | 116/139 [05:36<01:05,  2.84s/it] 84%|████████▍ | 117/139 [05:40<01:08,  3.09s/it] 85%|████████▍ | 118/139 [05:44<01:09,  3.29s/it] 86%|████████▌ | 119/139 [05:47<01:02,  3.13s/it] 86%|████████▋ | 120/139 [05:50<01:00,  3.17s/it] 87%|████████▋ | 121/139 [05:53<00:58,  3.23s/it] 88%|████████▊ | 122/139 [05:57<00:57,  3.38s/it] 88%|████████▊ | 123/139 [06:00<00:54,  3.41s/it] 89%|████████▉ | 124/139 [06:03<00:46,  3.12s/it] 90%|████████▉ | 125/139 [06:06<00:42,  3.04s/it] 91%|█████████ | 126/139 [06:09<00:40,  3.11s/it] 91%|█████████▏| 127/139 [06:12<00:36,  3.06s/it] 92%|█████████▏| 128/139 [06:15<00:32,  2.95s/it] 93%|█████████▎| 129/139 [06:19<00:32,  3.29s/it] 94%|█████████▎| 130/139 [06:22<00:29,  3.24s/it] 94%|█████████▍| 131/139 [06:26<00:29,  3.64s/it] 95%|█████████▍| 132/139 [06:31<00:26,  3.82s/it] 96%|█████████▌| 133/139 [06:33<00:20,  3.50s/it] 96%|█████████▋| 134/139 [06:36<00:16,  3.26s/it] 97%|█████████▋| 135/139 [06:39<00:12,  3.15s/it] 98%|█████████▊| 136/139 [06:43<00:10,  3.37s/it] 99%|█████████▊| 137/139 [06:45<00:06,  3.13s/it] 99%|█████████▉| 138/139 [06:48<00:03,  3.03s/it]100%|██████████| 139/139 [06:50<00:00,  2.63s/it]wandb: ERROR api_key not configured (no-tty). call wandb.login(key=[your_api_key])
Traceback (most recent call last):
  File "/zhome/8d/a/147395/masterproject/masterproject/src/finetunegemma.py", line 93, in <module>
    train()
  File "/zhome/8d/a/147395/masterproject/masterproject/src/finetunegemma.py", line 75, in train
    print(trainer.evaluate())
          ^^^^^^^^^^^^^^^^^^
  File "/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/transformers/trainer.py", line 3251, in evaluate
    self.log(output.metrics)
  File "/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/transformers/trainer.py", line 2822, in log
    self.control = self.callback_handler.on_log(self.args, self.state, self.control, logs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/transformers/trainer_callback.py", line 407, in on_log
    return self.call_event("on_log", args, state, control, logs=logs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/transformers/trainer_callback.py", line 414, in call_event
    result = getattr(callback, event)(
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/transformers/integrations/integration_utils.py", line 807, in on_log
    self.setup(args, state, model)
  File "/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/transformers/integrations/integration_utils.py", line 740, in setup
    self._wandb.init(
  File "/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 1195, in init
    raise e
  File "/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 1172, in init
    wi.setup(kwargs)
  File "/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 306, in setup
    wandb_login._login(
  File "/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/wandb/sdk/wandb_login.py", line 317, in _login
    wlogin.prompt_api_key()
  File "/zhome/8d/a/147395/miniconda3/envs/src/lib/python3.11/site-packages/wandb/sdk/wandb_login.py", line 247, in prompt_api_key
    raise UsageError("api_key not configured (no-tty). call " + directive)
wandb.errors.UsageError: api_key not configured (no-tty). call wandb.login(key=[your_api_key])
make: *** [finetunegemma] Error 1
